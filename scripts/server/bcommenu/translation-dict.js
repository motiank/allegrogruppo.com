/**
 * Global translation dictionary for common Hebrew food terms and phrases
 * This dictionary is shared across all menu import and conversion scripts
 * Used by: import_bcom_menu.js, convert-tower-menu.js, convert-beecomm-menu.js,
 *          fix-tower-translations.js, fix-labraca-translations.js, add-metadata-translations.js
 */

export const translationDict = {
  en: {
    // Common phrases
    'תוספות לתירס צלוי': 'Extras for Grilled Corn',
    'תוספות': 'Extras',
    'תוספת': 'Extra',
    'סוג פסטה': 'Pasta Type',
    'סוג': 'Type',
    'פסטה בהרכבה': 'Custom Pasta',
    'פסטה': 'Pasta',
    'פטוצ׳יני': 'Fettuccine',
    'פנה': 'Penne',
    'ספגטי ללא גלוטן': 'Gluten-free Spaghetti',
    'ספגטי': 'Spaghetti',
    'ללא גלוטן': 'Gluten-free',
    'פרמז׳ן': 'Parmesan',
    'קוקוס': 'Coconut',
    'צ׳ילי טרי': 'Fresh Chili',
    'חלפיניו': 'Jalapeño',
    'רוטב': 'Sauce',
    'רטבים': 'Sauces',
    'פסטה בולונז': 'Bolognese Pasta',
    'בולונז': 'Bolognese',
    'רוזה': 'Rosa',
    'אלפרדו': 'Alfredo',
    'תירס צלוי': 'Grilled Corn',
    'תירס': 'Corn',
    'צלוי': 'Grilled',
    'חסה': 'Lettuce',
    'עגבנייה': 'Tomato',
    'בצל': 'Onion',
    'מלפפון': 'Cucumber',
    'פלפל': 'Pepper',
    'גבינה': 'Cheese',
    'בשר': 'Meat',
    'עוף': 'Chicken',
    'דג': 'Fish',
    'סלמון': 'Salmon',
    'כריך': 'Sandwich',
    'סלט': 'Salad',
    'צ׳יפס': 'Fries',
    'אורז': 'Rice',
    'לחם': 'Bread',
    'שמנת': 'Cream',
    'קרם': 'Cream',
    'חדש': 'New',
    'שינויים אפשריים בכריך': 'Possible Changes in Sandwich',
    'שינויים': 'Changes',
    'אפשריים': 'Possible',
    'בכריך': 'in Sandwich',
    'מידת עשייה': 'Doneness level',
    'המבורגר קלאסי': 'Classic Hamburger',
    'המבורגר': 'Hamburger',
    'קלאסי': 'Classic',
    'שניצל': 'Schnitzel',
    'סלט ברזל': 'Iron Salad',
    'ברזל': 'Iron',
    'סלט ירוק': 'Green Salad',
    'ירוק': 'Green',
    'תפוח אדמה': 'Potato',
    'תפוחי אדמה': 'Potatoes',
    'סלט ירוק  תוספת': 'Green Salad Extra',
    'משקאות': 'Drinks',
    // Description terms
    'גרם': 'grams',
    'לחמניית בריוש': 'brioche bun',
    'מטוגן': 'fried',
    'לחם פריך': 'crispy bread',
    'לימון': 'lemon',
    'רוטב בולונז קלאסי': 'classic bolognese sauce',
    'בשר בקר טחון': 'ground beef',
    'יין אדום': 'red wine',
    'עלים ירוקים': 'green leaves',
    'תרד': 'spinach',
    'עגבניות שרי': 'cherry tomatoes',
    'גבינת פטה': 'feta cheese',
    'אגוזי מלך': 'walnuts',
    'טרי': 'fresh',
    'אפויים': 'baked',
    'או': 'or',
    'מטוגנים': 'fried',
    'איכותי': 'quality',
    'ירקות צלויים': 'grilled vegetables',
    'תבלינים': 'spices',
    'צלוי על הגריל': 'grilled',
    'דק': 'thin',
    'גבינת פרמזן': 'parmesan cheese',
    'רוקט': 'arugula',
    'שמן זית': 'olive oil',
    'איטלקי': 'Italian',
    'מתובל': 'seasoned',
    'חריף קלות': 'slightly spicy',
    'מיובש': 'dried',
    'בזיליקום': 'basil',
    'סיציליאנית': 'Sicilian',
    'חצילים': 'eggplant',
    'זיתים': 'olives',
    'צלפים': 'capers',
    'חתוך דק': 'thinly sliced',
    'רוטב חרדל': 'mustard sauce',
    'צלוי לאט': 'slow roasted',
    'ירקות שורש': 'root vegetables',
    'מוצרלה': 'mozzarella',
    'פפרוני': 'pepperoni',
    'פטריות': 'mushrooms',
    'גבינת גורגונזולה': 'gorgonzola cheese',
    'רוטב טרטר': 'tartar sauce',
    'נתחי עוף': 'chicken pieces',
    'רוטב דבש חריף': 'spicy honey sauce',
    'רוטב עגבניות': 'tomato sauce',
    'ירקות': 'vegetables',
    'ירקות טריים': 'fresh vegetables',
    'שיפודי כבש': 'lamb skewers',
    'תבלינים מזרחיים': 'Middle Eastern spices',
    'משתנה לפי היום': 'varies by day',
    'של השף': "chef's",
    'מנת ספיישל': 'special dish',
    'עגלה': 'veal',
    'סציליאני': 'Sicilian',
    'ועגבניה': 'and tomato',
    'ועגבנייה': 'and tomato',
    '250': '250',
  },
  ar: {
    // Common phrases
    'תוספות לתירס צלוי': 'إضافات للذرة المشوية',
    'תוספות': 'إضافات',
    'תוספת': 'إضافة',
    'סוג פסטה': 'نوع الباستا',
    'סוג': 'نوع',
    'פסטה בהרכבה': 'باستا مخصصة',
    'פסטה': 'باستا',
    'פטוצ׳יני': 'فيتوتشيني',
    'פנה': 'بيني',
    'ספגטי ללא גלוטן': 'سباغيتي خالية من الغلوتين',
    'ספגטי': 'سباغيتي',
    'ללא גלוטן': 'خالي من الغلوتين',
    'פרמז׳ן': 'بارميزان',
    'קוקוס': 'جوز الهند',
    'צ׳ילי טרי': 'فلفل حار طازج',
    'חלפיניו': 'هالبينو',
    'רוטב': 'صلصة',
    'רטבים': 'صلصات',
    'פסטה בולונז': 'باستا بولونيز',
    'בולונז': 'بولونيز',
    'רוזה': 'روزا',
    'אלפרדו': 'ألفريدو',
    'תירס צלוי': 'ذرة مشوية',
    'תירס': 'ذرة',
    'צלוי': 'مشوي',
    'חסה': 'خس',
    'עגבנייה': 'طماطم',
    'בצל': 'بصل',
    'מלפפון': 'خيار',
    'פלפל': 'فلفل',
    'גבינה': 'جبن',
    'בשר': 'لحم',
    'עוף': 'دجاج',
    'דג': 'سمك',
    'סלמון': 'سلمون',
    'כריך': 'ساندويتش',
    'סלט': 'سلطة',
    'צ׳יפס': 'بطاطا مقلية',
    'אורז': 'أرز',
    'לחם': 'خبز',
    'שמנת': 'كريمة',
    'קרם': 'كريمة',
    'חדש': 'جديد',
    'שינויים אפשריים בכריך': 'تغييرات محتملة في الساندويتش',
    'שינויים': 'تغييرات',
    'אפשריים': 'محتملة',
    'בכריך': 'في الساندويتش',
    'מידת עשייה': 'مستوى النضج',
    'המבורגר קלאסי': 'هامبرجر كلاسيكي',
    'המבורגר': 'هامبرجر',
    'קלאסי': 'كلاسيكي',
    'שניצל': 'شنتسل',
    'סלט ברזל': 'سلطة الحديد',
    'ברזל': 'حديد',
    'סלט ירוק': 'سلطة خضراء',
    'ירוק': 'أخضر',
    'תפוח אדמה': 'بطاطا',
    'תפוחי אדמה': 'بطاطا',
    'סלט ירוק  תוספת': 'سلطة خضراء إضافية',
    'משקאות': 'مشروبات',
    // Description terms
    'גרם': 'جرام',
    'לחמניית בריוש': 'كعكة بريوش',
    'מטוגן': 'مقلي',
    'לחם פריך': 'خبز مقرمش',
    'לימון': 'ليمون',
    'רוטב בולונז קלאסי': 'صلصة بولونيز كلاسيكية',
    'בשר בקר טחון': 'لحم بقري مفروم',
    'יין אדום': 'نبيذ أحمر',
    'עלים ירוקים': 'أوراق خضراء',
    'תרד': 'سبانخ',
    'עגבניות שרי': 'طماطم كرزية',
    'גבינת פטה': 'جبنة فيتا',
    'אגוזי מלך': 'جوز',
    'טרי': 'طازج',
    'אפויים': 'مخبوز',
    'או': 'أو',
    'מטוגנים': 'مقلية',
    'איכותי': 'عالي الجودة',
    'ירקות צלויים': 'خضار مشوية',
    'תבלינים': 'توابل',
    'צלוי על הגריל': 'مشوي على الشواية',
    'דק': 'رقيق',
    'גבינת פרמזן': 'جبنة بارميزان',
    'רוקט': 'جرجير',
    'שמן זית': 'زيت زيتون',
    'איטלקי': 'إيطالي',
    'מתובל': 'متبل',
    'חריף קלות': 'حار قليلاً',
    'מיובש': 'مجفف',
    'בזיליקום': 'ريحان',
    'סיציליאנית': 'صقلية',
    'חצילים': 'باذنجان',
    'זיתים': 'زيتون',
    'צלפים': 'قبار',
    'חתוך דק': 'مقطع رقيق',
    'רוטב חרדל': 'صلصة خردل',
    'צלוי לאט': 'مشوي ببطء',
    'ירקות שורש': 'خضار جذرية',
    'מוצרלה': 'موتزاريلا',
    'פפרוני': 'بيبروني',
    'פטריות': 'فطر',
    'גבינת גורגונזולה': 'جبنة جورجونزولا',
    'רוטב טרטר': 'صلصة التارتار',
    'נתחי עוף': 'قطع دجاج',
    'רוטב דבש חריף': 'صلصة عسل حارة',
    'רוטב עגבניות': 'صلصة الطماطم',
    'ירקות': 'خضار',
    'ירקות טריים': 'خضار طازجة',
    'שיפודי כבש': 'أسياخ لحم الضأن',
    'תבלינים מזרחיים': 'توابل شرقية',
    'משתנה לפי היום': 'يتغير حسب اليوم',
    'של השף': 'الشيف',
    'מנת ספיישל': 'طبق خاص',
    'עגלה': 'عجل',
    'סציליאני': 'صقلية',
    'ועגבניה': 'وطماطم',
    'ועגבנייה': 'وطماطم',
    '250': '250',
  },
  ru: {
    // Common phrases
    'תוספות לתירס צלוי': 'Добавки к жареной кукурузе',
    'תוספות': 'Добавки',
    'תוספת': 'Добавка',
    'סוג פסטה': 'Тип пасты',
    'סוג': 'Тип',
    'פסטה בהרכבה': 'Паста на заказ',
    'פסטה': 'Паста',
    'פטוצ׳יני': 'Феттучине',
    'פנה': 'Пенне',
    'ספגטי ללא גלוטן': 'Спагетти без глютена',
    'ספגטי': 'Спагетти',
    'ללא גלוטן': 'Без глютена',
    'פרמז׳ן': 'Пармезан',
    'קוקוס': 'Кокос',
    'צ׳ילי טרי': 'Свежий перец чили',
    'חלפיניו': 'Халапеньо',
    'רוטב': 'Соус',
    'רטבים': 'Соусы',
    'פסטה בולונז': 'Паста болоньезе',
    'בולונז': 'Болоньезе',
    'רוזה': 'Роза',
    'אלפרדו': 'Альфредо',
    'תירס צלוי': 'Жареная кукуруза',
    'תירס': 'Кукуруза',
    'צלוי': 'Жареный',
    'חסה': 'Салат',
    'עגבנייה': 'Помидор',
    'בצל': 'Лук',
    'מלפפון': 'Огурец',
    'פלפל': 'Перец',
    'גבינה': 'Сыр',
    'בשר': 'Мясо',
    'עוף': 'Курица',
    'דג': 'Рыба',
    'סלמון': 'Лосось',
    'כריך': 'Сэндвич',
    'סלט': 'Салат',
    'צ׳יפס': 'Картофель фри',
    'אורז': 'Рис',
    'לחם': 'Хлеб',
    'שמנת': 'Сливки',
    'קרם': 'Сливки',
    'חדש': 'Новый',
    'שינויים אפשריים בכריך': 'Возможные изменения в сэндвиче',
    'שינויים': 'Изменения',
    'אפשריים': 'Возможные',
    'בכריך': 'в сэндвиче',
    'מידת עשייה': 'Уровень прожарки',
    'המבורגר קלאסי': 'Классический гамбургер',
    'המבורגר': 'Гамбургер',
    'קלאסי': 'Классический',
    'שניצל': 'Шницель',
    'סלט ברזל': 'Железный салат',
    'ברזל': 'Железо',
    'סלט ירוק': 'Зеленый салат',
    'ירוק': 'Зеленый',
    'תוספת': 'Добавка',
    'תפוח אדמה': 'Картофель',
    'תפוחי אדמה': 'Картофель',
    'סלט ירוק  תוספת': 'Зеленый салат дополнительно',
    'משקאות': 'Напитки',
    // Description terms
    'גרם': 'грамм',
    'לחמניית בריוש': 'булочка бриошь',
    'מטוגן': 'жареный',
    'לחם פריך': 'хрустящий хлеб',
    'לימון': 'лимон',
    'רוטב בולונז קלאסי': 'классический соус болоньезе',
    'בשר בקר טחון': 'говяжий фарш',
    'יין אדום': 'красное вино',
    'עלים ירוקים': 'зеленые листья',
    'תרד': 'шпинат',
    'עגבניות שרי': 'черри помидоры',
    'גבינת פטה': 'сыр фета',
    'אגוזי מלך': 'грецкие орехи',
    'טרי': 'свежий',
    'מלפפון': 'огурец',
    'אפויים': 'запеченный',
    'או': 'или',
    'מטוגנים': 'жареный',
    'איכותי': 'качественный',
    'ירקות צלויים': 'жареные овощи',
    'תבלינים': 'специи',
    'צלוי על הגריל': 'жареный на гриле',
    'דק': 'тонкий',
    'גבינת פרמזן': 'сыр пармезан',
    'רוקט': 'руккола',
    'שמן זית': 'оливковое масло',
    'איטלקי': 'итальянский',
    'מתובל': 'приправленный',
    'חריף קלות': 'слегка острый',
    'מיובש': 'сушеный',
    'בזיליקום': 'базилик',
    'סיציליאנית': 'сицилийский',
    'חצילים': 'баклажан',
    'זיתים': 'оливки',
    'צלפים': 'каперсы',
    'חתוך דק': 'тонко нарезанный',
    'רוטב חרדל': 'горчичный соус',
    'צלוי לאט': 'медленно жареный',
    'ירקות שורש': 'корнеплоды',
    'מוצרלה': 'моцарелла',
    'פפרוני': 'пепперони',
    'פטריות': 'грибы',
    'גבינת גורגונזולה': 'сыр горгонзола',
    'רוטב טרטר': 'соус тартар',
    'נתחי עוף': 'кусочки курицы',
    'רוטב דבש חריף': 'острый медовый соус',
    'רוטב עגבניות': 'томатный соус',
    'ירקות': 'овощи',
    'ירקות טריים': 'свежие овощи',
    'רוטב': 'соус',
    'שיפודי כבש': 'шашлык из баранины',
    'תבלינים מזרחיים': 'восточные специи',
    'משתנה לפי היום': 'меняется в зависимости от дня',
    'של השף': 'шеф-повара',
    'מנת ספיישל': 'особое блюдо',
    'עגלה': 'телятина',
    'סציליאני': 'сицилийский',
    'ועגבניה': 'и помидор',
    'ועגבנייה': 'и помидор',
    '250': '250',
  },
};

/**
 * Helper function to check if text is Hebrew (contains Hebrew characters)
 * @param {string} text - Text to check
 * @returns {boolean} - True if text contains Hebrew characters
 */
export function isHebrew(text) {
  if (!text || typeof text !== 'string') return false;
  return /[\u0590-\u05FF]/.test(text);
}

/**
 * Helper function to translate Hebrew text using the dictionary
 * @param {string} hebrewText - Hebrew text to translate
 * @param {string} lang - Target language ('en', 'ar', 'ru')
 * @returns {string} - Translated text
 */
export function translateHebrew(hebrewText, lang) {
  if (!hebrewText || !isHebrew(hebrewText)) return hebrewText;
  
  const dict = translationDict[lang] || {};
  let translated = hebrewText.trim();
  
  // First, try to find exact phrase matches (longer phrases first)
  const sortedKeys = Object.keys(dict).sort((a, b) => b.length - a.length);
  for (const hebrew of sortedKeys) {
    if (translated.includes(hebrew)) {
      // Replace all occurrences of the Hebrew phrase with its translation
      translated = translated.replace(new RegExp(hebrew.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g'), dict[hebrew]);
    }
  }
  
  // If we still have Hebrew characters, try word-by-word translation
  if (isHebrew(translated)) {
    // Split by common separators and translate each word
    const words = translated.split(/[\s,]+/).filter(w => w.trim());
    const translatedWords = words.map(word => {
      const trimmedWord = word.trim();
      if (!trimmedWord || !isHebrew(trimmedWord)) return trimmedWord;
      // Try to find translation for this word
      for (const hebrew of sortedKeys) {
        if (trimmedWord === hebrew || trimmedWord.includes(hebrew)) {
          return dict[hebrew] || trimmedWord;
        }
      }
      return trimmedWord;
    });
    translated = translatedWords.join(' ');
  }
  
  // Clean up extra spaces
  translated = translated.replace(/\s+/g, ' ').trim();
  
  return translated;
}

/**
 * Helper function to get proper translation
 * If translation exists and is not Hebrew, use it; otherwise try to translate or use fallback
 * @param {string} hebrewText - Hebrew text
 * @param {Object} nameTranslate - Translation object from menu data
 * @param {string} lang - Target language ('en', 'ar', 'ru')
 * @returns {string} - Translated text
 */
export function getTranslation(hebrewText, nameTranslate, lang) {
  // If we have a translation for this language
  if (nameTranslate && nameTranslate[lang]) {
    const translation = nameTranslate[lang].trim();
    // If translation exists and is not just Hebrew text, use it
    if (translation && !isHebrew(translation)) {
      return translation;
    }
  }
  
  // If no proper translation, try to translate from Hebrew
  return translateHebrew(hebrewText, lang);
}
